_____________________________________________________________
salam            khobi 123     456
----------------------------------
salam
----------------------------------
khobi
----------------------------------
123
----------------------------------
456
_____________________________________________________________
!monitor 123 1234 script { tesTo                     salam 

khoobi?
 }
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
 tesTo                     salam 

khoobi?
 
_____________________________________________________________
 !monitor rwx 123 1234 script { @rax= @rbx;                      

printf("ho");
 }
----------------------------------
!monitor
----------------------------------
rwx
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
 @rax= @rbx;                      

printf("ho");
 
_____________________________________________________________





!monitor 123 1234 script { tesTo                     salam 

khoobi?
 }
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
 tesTo                     salam 

khoobi?
 
_____________________________________________________________
 help    settings
----------------------------------
help
----------------------------------
settings
_____________________________________________________________
help    settings
----------------------------------
help
----------------------------------
settings
_____________________________________________________________
 !monitor 123 1234 script {salam}
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
salam
_____________________________________________________________
 !monitor 123 1234 script { salam}
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
 salam
_____________________________________________________________
 !monitor 123 1234 script {salam }
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
salam 
_____________________________________________________________
 !monitor 123 1234 script {-} script {salam } 
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
-
----------------------------------
script
----------------------------------
salam 
_____________________________________________________________
 !monitor 123 1234 script {-
 
 
 
 
 } script {salam } 
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
-
 
 
 
 
 
----------------------------------
script
----------------------------------
salam 
_____________________________________________________________
!command -flag1 -flag2 input {   value1   value2   }
----------------------------------
!command
----------------------------------
-flag1
----------------------------------
-flag2
----------------------------------
input
----------------------------------
   value1   value2   
_____________________________________________________________
combine    {first   part}  { second part } {third part}
----------------------------------
combine
----------------------------------
first   part
----------------------------------
 second part 
----------------------------------
third part
_____________________________________________________________
mix { spaces   inside }  and {no space}
----------------------------------
mix
----------------------------------
 spaces   inside 
----------------------------------
and
----------------------------------
no space
_____________________________________________________________
testcase1 testcase2 {  enclosed with spaces  }
----------------------------------
testcase1
----------------------------------
testcase2
----------------------------------
  enclosed with spaces  
_____________________________________________________________
!action -key1=value1 -key2=value2 {payload   data} 
----------------------------------
!action
----------------------------------
-key1=value1
----------------------------------
-key2=value2
----------------------------------
payload   data
_____________________________________________________________
cmd {first block} subsequent {second block} ending
----------------------------------
cmd
----------------------------------
first block
----------------------------------
subsequent
----------------------------------
second block
----------------------------------
ending
_____________________________________________________________
!start -fast {quick action} -secure {safe mode}
----------------------------------
!start
----------------------------------
-fast
----------------------------------
quick action
----------------------------------
-secure
----------------------------------
safe mode
_____________________________________________________________
simple   command    with {  embedded data   }
----------------------------------
simple
----------------------------------
command
----------------------------------
with
----------------------------------
  embedded data   
_____________________________________________________________
cmd1 cmd2 cmd3 {sequential commands}
----------------------------------
cmd1
----------------------------------
cmd2
----------------------------------
cmd3
----------------------------------
sequential commands
_____________________________________________________________
!launch -now -force {immediate start} && {verify} 
----------------------------------
!launch
----------------------------------
-now
----------------------------------
-force
----------------------------------
immediate start
----------------------------------
&&
----------------------------------
verify
_____________________________________________________________
   
!script    launch { @init(); } followed by {execute main;}
----------------------------------
!script
----------------------------------
launch
----------------------------------
 @init(); 
----------------------------------
followed
----------------------------------
by
----------------------------------
execute main;
_____________________________________________________________
cmd {simple} {sequence} -option
----------------------------------
cmd
----------------------------------
simple
----------------------------------
sequence
----------------------------------
-option
_____________________________________________________________
run -flag1 {data1} -flag2 {data2} -flag3 {data3}
----------------------------------
run
----------------------------------
-flag1
----------------------------------
data1
----------------------------------
-flag2
----------------------------------
data2
----------------------------------
-flag3
----------------------------------
data3
_____________________________________________________________
test -x -y -z {set1} and {set2} followed by {set3}
----------------------------------
test
----------------------------------
-x
----------------------------------
-y
----------------------------------
-z
----------------------------------
set1
----------------------------------
and
----------------------------------
set2
----------------------------------
followed
----------------------------------
by
----------------------------------
set3
_____________________________________________________________
init {first} then {second} && finally {third} 
----------------------------------
init
----------------------------------
first
----------------------------------
then
----------------------------------
second
----------------------------------
&&
----------------------------------
finally
----------------------------------
third
_____________________________________________________________
long command with {multiple parts in} {separate blocks} 
----------------------------------
long
----------------------------------
command
----------------------------------
with
----------------------------------
multiple parts in
----------------------------------
separate blocks
_____________________________________________________________
simple {standalone block}
----------------------------------
simple
----------------------------------
standalone block
_____________________________________________________________
trigger {script  } && -flag {option}   final
----------------------------------
trigger
----------------------------------
script  
----------------------------------
&&
----------------------------------
-flag
----------------------------------
option
----------------------------------
final
_____________________________________________________________
initiate --parameters { --data="complex value"; return 0;} and end
----------------------------------
initiate
----------------------------------
--parameters
----------------------------------
 --data="complex value"; return 0;
----------------------------------
and
----------------------------------
end
_____________________________________________________________
multi-step {process} && {handle} then {finalize}
----------------------------------
multi-step
----------------------------------
process
----------------------------------
&&
----------------------------------
handle
----------------------------------
then
----------------------------------
finalize
_____________________________________________________________
cmd -flag1 -flag2 {parameter} {another} part
----------------------------------
cmd
----------------------------------
-flag1
----------------------------------
-flag2
----------------------------------
parameter
----------------------------------
another
----------------------------------
part
_____________________________________________________________
test {unmatched brackets and inputs
----------------------------------
test
----------------------------------
unmatched brackets and inputs
_____________________________________________________________
{no command} just {brackets   here} 
----------------------------------
no command
----------------------------------
just
----------------------------------
brackets   here
_____________________________________________________________

     !monitor 123 1234 script { salam { } }


----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
 salam { } 
_____________________________________________________________
 !monitor 123 1234 script {salam { }}
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
salam { }
_____________________________________________________________
 !monitor 123 1234 script {{}} script {salam } 
----------------------------------
!monitor
----------------------------------
123
----------------------------------
1234
----------------------------------
script
----------------------------------
{}
----------------------------------
script
----------------------------------
salam 
_____________________________________________________________
!run   multiple   {commands here; print("hello") }   now
----------------------------------
!run
----------------------------------
multiple
----------------------------------
commands here; print("hello") 
----------------------------------
now
_____________________________________________________________
execute    --option=value   --flag {do this}  &&  {do that}
----------------------------------
execute
----------------------------------
--option=value
----------------------------------
--flag
----------------------------------
do this
----------------------------------
&&
----------------------------------
do that
_____________________________________________________________
test   input     multiple { nested   {token1 token2}  token3  }
----------------------------------
test
----------------------------------
input
----------------------------------
multiple
----------------------------------
 nested   {token1 token2}  token3  
_____________________________________________________________
!example   with-symbols  { $var1   =   @func(); }  @end
----------------------------------
!example
----------------------------------
with-symbols
----------------------------------
 $var1   =   @func(); 
----------------------------------
@end
_____________________________________________________________
check  {brackets}without   spaces   {another}one
----------------------------------
check
----------------------------------
brackets
----------------------------------
without
----------------------------------
spaces
----------------------------------
another
----------------------------------
one
_____________________________________________________________
trigger    --conditionA  --conditionB  sequence {if(A) {exec B;}}
----------------------------------
trigger
----------------------------------
--conditionA
----------------------------------
--conditionB
----------------------------------
sequence
----------------------------------
if(A) {exec B;}
_____________________________________________________________
check -flag { first {nested} block } and another
----------------------------------
check
----------------------------------
-flag
----------------------------------
 first {nested} block 
----------------------------------
and
----------------------------------
another
_____________________________________________________________

cmd -opt1 --opt2 {multi-level { nesting  }  example }
----------------------------------
cmd
----------------------------------
-opt1
----------------------------------
--opt2
----------------------------------
multi-level { nesting  }  example 
_____________________________________________________________

prefix {command with {extra} spaces} suffix
----------------------------------
prefix
----------------------------------
command with {extra} spaces
----------------------------------
suffix
_____________________________________________________________
{edge case} with {close} but {mismatched }
----------------------------------
edge case
----------------------------------
with
----------------------------------
close
----------------------------------
but
----------------------------------
mismatched 
_____________________________________________________________

cmd1 {with spaces  }between  {tokens}
----------------------------------
cmd1
----------------------------------
with spaces  
----------------------------------
between
----------------------------------
tokens
_____________________________________________________________

execute     command --with-options {enclose {inner block} complete} 
----------------------------------
execute
----------------------------------
command
----------------------------------
--with-options
----------------------------------
enclose {inner block} complete
_____________________________________________________________
combine  --flags { group {of {nested} data} here }
----------------------------------
combine
----------------------------------
--flags
----------------------------------
 group {of {nested} data} here 
_____________________________________________________________

launch   operation {perform   task   with  details*&^%$#@! }
----------------------------------
launch
----------------------------------
operation
----------------------------------
perform   task   with  details*&^%$#@! 
_____________________________________________________________
{beginning}{middle}{end} as a story
----------------------------------
beginning
----------------------------------
middle
----------------------------------
end
----------------------------------
as
----------------------------------
a
----------------------------------
story
_____________________________________________________________
process   data {with   embedded {brackets} and symbols!@# }
----------------------------------
process
----------------------------------
data
----------------------------------
with   embedded {brackets} and symbols!@# 
_____________________________________________________________
{part1} {part2} {part3} followed by {part4}
----------------------------------
part1
----------------------------------
part2
----------------------------------
part3
----------------------------------
followed
----------------------------------
by
----------------------------------
part4
_____________________________________________________________
trigger   function {execute this {with nested} commands}
----------------------------------
trigger
----------------------------------
function
----------------------------------
execute this {with nested} commands
_____________________________________________________________
{first}{second}{third}{fourth} in order
----------------------------------
first
----------------------------------
second
----------------------------------
third
----------------------------------
fourth
----------------------------------
in
----------------------------------
order
_____________________________________________________________
invoke action {with parameters and special *&^%$#@! characters}
----------------------------------
invoke
----------------------------------
action
----------------------------------
with parameters and special *&^%$#@! characters
_____________________________________________________________
{alpha}{beta}{gamma} proceed
----------------------------------
alpha
----------------------------------
beta
----------------------------------
gamma
----------------------------------
proceed
_____________________________________________________________
launch command {multiple levels {of nested} structures}
----------------------------------
launch
----------------------------------
command
----------------------------------
multiple levels {of nested} structures
_____________________________________________________________
{start}{continue}{finish} the process
----------------------------------
start
----------------------------------
continue
----------------------------------
finish
----------------------------------
the
----------------------------------
process
_____________________________________________________________
execute   command {execute {inner} logic } finalize
----------------------------------
execute
----------------------------------
command
----------------------------------
execute {inner} logic 
----------------------------------
finalize
_____________________________________________________________

run    long command {with   spaces and symbols!@#$%^&*() }  
----------------------------------
run
----------------------------------
long
----------------------------------
command
----------------------------------
with   spaces and symbols!@#$%^&*() 
_____________________________________________________________

!inject  kernel!IoCreateFile script {

memcpy(" {                             buffer content @0x%x\n", @rdx);


}
----------------------------------
!inject
----------------------------------
kernel!IoCreateFile
----------------------------------
script
----------------------------------


memcpy(" {                             buffer content @0x%x\n", @rdx);



_____________________________________________________________
!hook  routine!KeWaitForSingleObject script { 

if (condition) {                              {   wait @timeout\n"," @rcx);}}

}
----------------------------------
!hook
----------------------------------
routine!KeWaitForSingleObject
----------------------------------
script
----------------------------------
 

if (condition) {                              {   wait @timeout\n"," @rcx);}}


_____________________________________________________________
!trace nt!ZwQuerySystemInformation script {

DbgPrint(" {                           {   system info: %p\n", @r8);   

}
----------------------------------
!trace
----------------------------------
nt!ZwQuerySystemInformation
----------------------------------
script
----------------------------------


DbgPrint(" {                           {   system info: %p\n", @r8);   


_____________________________________________________________
!monitor function!NtOpenProcess script {

log(" {                                   {   process opened: %d\n", @r9);


}
----------------------------------
!monitor
----------------------------------
function!NtOpenProcess
----------------------------------
script
----------------------------------


log(" {                                   {   process opened: %d\n", @r9);



_____________________________________________________________
!filter   nt!MmMapLockedPagesSpecifyCache script {

trace(" {                             {   mapping pages @%p\n", @r10);

}
----------------------------------
!filter
----------------------------------
nt!MmMapLockedPagesSpecifyCache
----------------------------------
script
----------------------------------


trace(" {                             {   mapping pages @%p\n", @r10);


_____________________________________________________________
!watch kernel!ObReferenceObjectByHandle script {

check(" {                             {   object handle: 0x%x\n","xxx" @r11);

}
----------------------------------
!watch
----------------------------------
kernel!ObReferenceObjectByHandle
----------------------------------
script
----------------------------------


check(" {                             {   object handle: 0x%x\n","xxx" @r11);


_____________________________________________________________
!watch kernel!ObReferenceObjectByHandle script { }{

check(" {                             {   object handle: 0x%x\n", @r11);

}
----------------------------------
!watch
----------------------------------
kernel!ObReferenceObjectByHandle
----------------------------------
script
----------------------------------
 
----------------------------------


check(" {                             {   object handle: 0x%x\n", @r11);


_____________________________________________________________
!watch kernel!ObReferenceObjectByHandle script { }{

check(" }  object handle: 0x%x\n", @r11);  

}
----------------------------------
!watch
----------------------------------
kernel!ObReferenceObjectByHandle
----------------------------------
script
----------------------------------
 
----------------------------------


check(" }  object handle: 0x%x\n", @r11);  


_____________________________________________________________
{block1}{block2}{block3} in sequence
----------------------------------
block1
----------------------------------
block2
----------------------------------
block3
----------------------------------
in
----------------------------------
sequence
_____________________________________________________________

!epthook nt!ExAllocatePoolWithTag script { 

printf(" {                                    {   hi2 ! :%llx\n", @rax);

}
----------------------------------
!epthook
----------------------------------
nt!ExAllocatePoolWithTag
----------------------------------
script
----------------------------------
 

printf(" {                                    {   hi2 ! :%llx\n", @rax);


_____________________________________________________________

!epthook nt!ExAllocatePoolWithTag script { 

printf(" {                                    {   hi ! :%llx\n", @rax);

}
----------------------------------
!epthook
----------------------------------
nt!ExAllocatePoolWithTag
----------------------------------
script
----------------------------------
 

printf(" {                                    {   hi ! :%llx\n", @rax);


_____________________________________________________________